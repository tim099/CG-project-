#version 400 core

layout(triangles)in;
layout(triangle_strip,max_vertices=3)out;

in VertexDataOut {
	vec2 UV;
	vec3 Normal;
	vec4 position;
	vec4 MVP_pos;
}vertout[3];

out VertexData{
	vec2 UV;
	vec3 Normal;
	vec4 position;
	vec4 MVP_pos;
	vec3 T;
	vec3 B;
}vert;
void main(){
	vec3 T;
	vec3 B;
    if(vertout[0].Normal!=vec3(0.3,0.3,0.3))T=normalize(cross(vertout[0].Normal,vec3(0.3,0.3,0.3)));
	else T=normalize(cross(vertout[0].Normal,vec3(0.31,0.29,0.31)));
	vertout[0].B=normalize(cross(vertout[0].Normal,T));
	for(int i=0;i<3;i++){
		gl_Position=gl_in[i].gl_Position;
		vert.UV=vertout[i].UV;
		vert.Normal=vertout[i].Normal;
		vert.position=vertout[i].position;
		vert.MVP_pos=vertout[i].MVP_pos;
		vert.T=T;
		vert.B=B;
		EmitVertex();
	}
	EndPrimitive();
} 